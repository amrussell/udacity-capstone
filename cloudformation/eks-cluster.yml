Description: >
    EKS Cluster for Alex Russell's Udacity capstone

Parameters:
    ClusterRoleArn:
        Description: ARN of cluster role
        Type: String
    NodegroupRoleArn:
        Description: ARN of nodegroup role
        Type: String
Resources:
    Cluster:
        Type: AWS::EKS::Cluster
        Properties:
            Name: UdacityCapstoneCluster
            RoleArn: !Sub ${ClusterRoleArn}
            ResourcesVpcConfig:
                SecurityGroupIds:
                    - sg-2d76dc20
                SubnetIds:
                    - subnet-0054794d
                    - subnet-1afb6545

    NodeGroup:
        Type: AWS::EKS::Nodegroup
        Properties:
            ClusterName: UdacityCapstoneCluster
            NodegroupName: CapstoneNodegroup
            NodeRole: !Sub ${NodegroupRoleArn}
            Subnets:
                - subnet-0054794d
                - subnet-1afb6545
        DependsOn: [Cluster]


